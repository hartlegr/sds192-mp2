---
title: "Mini-Project 2"
author: "Grace Hartley, Amrita Acharya, Callie Slevin"
date: "2019-03-24"
output: 
  html_document:
    code_folding: hide
---

^[https://github.com/hartlegr/sds192-mp2]

```{r, message=FALSE}
library(tidyverse)
library(extrafont)
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
devtools::install_github("benmarwick/wordcountaddin", type="source", dependencies=TRUE)

```

```{r}
wordcountaddin::word_count("mp2.rmd")

```

First, we joined the candidates table and the contributions table using the "cand_id."
```{r}
cand_contrib <- candidates%>% 
  left_join(contributions, "cand_id")
```

 
```{r, message=FALSE, eval=FALSE}
cand_contrib%>%
  filter(cand_election_yr == 2012)%>% 
  filter(cand_ici== "I")%>%
  group_by(cand_id, cand_name)%>%
  summarize(total_cont = sum(transaction_amt, na.rm = TRUE))
  
  

```

```{r, eval=FALSE}
ron_kind <- candidates %>%
  filter(cand_name == "KIND, RON")
```

```{r, eval=FALSE}
library(Stat2Data)
tally(~transaction_type, data = cand_contrib)
```

Then, we only filtered out candidates who last ran in 2012, removing the rows with NA data. We grouped by transaction type, and then...
```{r}
cand_contrib <- cand_contrib%>%
  filter(cand_election_yr == 2012)%>% 
  na.omit() %>%
  group_by(transaction_type)%>%
  mutate(for_cand = ifelse(transaction_type == "24K"|transaction_type ==  "24E", "forcan","agcan"))
 
```


```{r, message=FALSE, warning=FALSE}
contrib_for <- cand_contrib %>%
  filter(!is.na("for_cand"))%>%
  filter(for_cand == "forcan")
 

contrib_ag <- cand_contrib %>%
  filter(for_cand == "agcan")%>%
  filter(!is.na("ag_cand"))
```

```{r, warning=FALSE, eval=FALSE}

boxplot <- ggplot(cand_contrib, aes(for_cand, log10(transaction_amt))) + geom_boxplot(color = "cornflowerblue")
boxplot
```

```{r, warning=FALSE, eval=FALSE}
contrib_forplot <- ggplot(contrib_for, aes(x = cand_ici, log10(transaction_amt))) + geom_boxplot()

contrib_forplot

contrib_foragplot <- ggplot(cand_contrib, aes(x = cand_ici, log10(transaction_amt))) + geom_boxplot(color = "cornflowerblue") + facet_wrap(~for_cand) 

contrib_foragplot
```

```{r, eval=FALSE}
library(ggthemes)
contrib_forplot <- ggplot(contrib_for, aes(x = cand_ici), log10(transaction_amt)) + geom_bar()

contrib_forplot
```


```{r}
labels<-c(agcan="Against Candidate", forcan="For Candidate")

```

The bar graph implemented here displays the amount of money contributed to the campaigns of: challengers, incumbents, and open seat canidates in the year 2012. The graphic on the left shows money spent against the canidate, and the graphic on the right shows money spent in favor of the canidate. 
```{r}
library(ggthemes)
contrib_foragplot <- ggplot(cand_contrib, aes(x = cand_ici), transaction_amt) + geom_bar( fill = "darkgoldenrod1") + facet_wrap(~for_cand, labeller=labeller(for_cand=labels)) +
  theme_economist()+
  xlab("")+
  scale_x_discrete(labels=c("Challenger", "Incumbent", "Open Seat"))+
  ylab("Total contributions (US $)")

contrib_foragplot
```

This displays that the most money was spent against challengers, and the least money was spent against canidates where there was no incumbent. However, the variation between the three categories is small. This might be due to...

We can also see that in 2012, the most money was spent for incumbents by far. Incumbents might have more support because they have had more time to gain the trust of their constituents. (this isn't saying what I'm trying to say lol)

Generalized function:
```{r}
contrib_any_year<-function(year){
  cand_contrib_yearly<-cand_contrib%>%
  filter(cand_election_yr == year)%>% 
  na.omit() %>%
  group_by(transaction_type)%>%
  mutate(for_cand = ifelse(transaction_type == "24K"|transaction_type ==  "24E", "forcan","agcan"))
  
  cand_contrib_yearly
  
  contrib_foragplot <- ggplot(cand_contrib_yearly, aes(x = cand_ici), transaction_amt) + geom_bar( fill = "darkgoldenrod1") + facet_wrap(~for_cand, labeller=labeller(for_cand=labels)) +
  theme_economist()+
  xlab("")+
  scale_x_discrete(labels=c("Challenger", "Incumbent", "Open Seat"))+
  ylab("Total contributions (US $)")

contrib_foragplot
}
```


```{r}
years<-c(1990, 1992, 1994, 1996, 1998, 2000, 2002, 2004, 2006, 2008, 2010, 2012, 2014)

#contrib_any_year(2004)
```
(^only works in 2012?)



