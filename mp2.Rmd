---
title: "Mini-Project 2: Do Incumbents Receive More Money?"
author: "Grace Hartley, Amrita Acharya, Callie Slevin"
date: "2019-03-24"
output: 
  html_document:
    code_folding: hide
---

^[https://github.com/hartlegr/sds192-mp2]

```{r, message=FALSE}
library(tidyverse)
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
devtools::install_github("benmarwick/wordcountaddin")

wordcountaddin::word_count("mp2.rmd")

```

We were interested in the sum of contributions made for and against the campaigns of different statuses of canidates (challenger, incumbent, and open seat canidates).

First, we joined the candidates table and the contributions table using the "cand_id."
```{r}
cand_contrib <- candidates%>% 
  left_join(contributions, "cand_id")
```


```{r, eval=FALSE}
library(Stat2Data)
tally(~transaction_type, data = cand_contrib)
```

Then, we filtered for the year 2012, while removing the rows with NA data. This provided us with all the contributions for canidates who last ran for office in 2012. We grouped the contributions by transaction type, and then mutated to add a column called 'for_cand'. This column provided information on whether the contribution was in favor of or in opposition of the canidate listed, listing either 'forcan' or 'agcan' respectively. 
```{r}
cand_contrib <- cand_contrib%>%
  filter(cand_election_yr == 2012)%>% 
  na.omit() %>%
  group_by(transaction_type)%>%
  mutate(for_cand = ifelse(transaction_type == "24K"|transaction_type ==  "24E", "forcan","agcan"))
 
```

We used this wrangled data to create the bar graph shown here. It displays the total amount of money contributed in favor of and in opposition of: challengers, incumbents, and open seat canidates in 2012. 
```{r}
library(ggthemes)

labels<-c(agcan="Against Candidate", forcan="For Candidate")

contrib_foragplot <- ggplot(cand_contrib, aes(x = cand_ici), transaction_amt) + geom_bar( fill = "darkgoldenrod1") + facet_wrap(~for_cand, labeller=labeller(for_cand=labels)) +
  theme_economist()+theme(legend.position = "none",
        axis.title.x = element_blank(), 
        axis.title.y = element_text(size=18, family="Andale Mono"),
         plot.title=element_text(size=20, family = "Andale Mono"), 
        axis.text.x = element_text(family = "Andale Mono"), 
        axis.text.y = element_text(family = "Andale Mono"))+
  scale_x_discrete(labels=c("Challenger", "Incumbent", "Open Seat"))+
  ylab("Total contributions (U.S. $)")+
  labs(title="  Campaign Contributions in 2012")

contrib_foragplot
```

This plot conveys that the total money spent on challengers and open seat canidates does not vary significantly when looking at whether the money was spent for or against the campaigns. Incumbents, however, received almost 10 times more money than was spent against them. This is likely because incumbents are already experienced with creating and supporting policies

- people know who they are
- they have already done stuff
- they have ties and connections in congress that pay off

Also interesting:
- in all three subgroups, the amount of money spent for canidates was more than spent against
- the least money spent against canidates was when there was an open seat, because neither person had done things that needed to be condoned OR less of a giant to slay (taking down incumbent)



Generalized function: We tried to do more than one year, but failed because...2012
```{r}
contrib_any_year<-function(year){
  cand_contrib_yearly<-cand_contrib%>%
  filter(cand_election_yr == year)%>% 
  na.omit() %>%
  group_by(transaction_type)%>%
  mutate(for_cand = ifelse(transaction_type == "24K"|transaction_type ==  "24E", "forcan","agcan"))
  
 cand_contrib_yearly
  
  contrib_foragplot <- ggplot(cand_contrib_yearly, aes(x = cand_ici), transaction_amt) + geom_bar( fill = "darkgoldenrod1") + facet_wrap(~for_cand, labeller=labeller(for_cand=labels)) +
  theme_economist()+theme(legend.position = "none",
        axis.title.x = element_blank(), 
        axis.title.y = element_text(size=18, family="Andale Mono"),
         plot.title=element_text(size=20, family = "Andale Mono"), 
        axis.text.x = element_text(family = "Andale Mono"), 
        axis.text.y = element_text(family = "Andale Mono"))+
  scale_x_discrete(labels=c("Challenger", "Incumbent", "Open Seat"))+
  ylab("Total contributions (U.S. $)")

contrib_foragplot
}
```


```{r}
years<-c(1990, 1992, 1994, 1996, 1998, 2000, 2002, 2004, 2006, 2008, 2010, 2012, 2014)

contrib_any_year(2012)
```


```{r, message=FALSE, warning=FALSE, eval=FALSE}
contrib_for <- cand_contrib %>%
  filter(!is.na("for_cand"))%>%
  filter(for_cand == "forcan")
 

contrib_ag <- cand_contrib %>%
  filter(for_cand == "agcan")%>%
  filter(!is.na("ag_cand"))
```

```{r, warning=FALSE, eval=FALSE}

boxplot <- ggplot(cand_contrib, aes(for_cand, log10(transaction_amt))) + geom_boxplot(color = "cornflowerblue")
boxplot
```

```{r, warning=FALSE, eval=FALSE}
contrib_forplot <- ggplot(contrib_for, aes(x = cand_ici, log10(transaction_amt))) + geom_boxplot()

contrib_forplot

contrib_foragplot <- ggplot(cand_contrib, aes(x = cand_ici, log10(transaction_amt))) + geom_boxplot(color = "cornflowerblue") + facet_wrap(~for_cand) 

contrib_foragplot
```

